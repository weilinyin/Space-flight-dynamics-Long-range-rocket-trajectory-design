# 航天飞行动力学远程火箭弹道设计大作业

> FT042201 2022300766 魏鳞隐

## 初始状态和有关参数

### 变量定义及初值

| 序号 | 变量名           | 初值                                                   | 物理意义及单位                        |
| ---- | ---------------- | ------------------------------------------------------ | ------------------------------------- |
| 0    | $t$              | 0                                                      | 火箭飞行时间，s                       |
| 1    | $\theta$         | $ \frac{\pi}{2}$                                       | 弹道倾角，rad（发射坐标系）           |
| 2    | $\vec{V}$        | $\left [\begin{matrix}0 \\ 0.1 \\0\end{matrix}\right]$ | 火箭速度，$m/s$（发射坐标系）         |
| 4    | $\vec{r}$        | $\left [\begin{matrix}0 \\ 0 \\0\end{matrix}\right]$   | 火箭在地面发射坐标系下的矢径,m        |
| 5    | $m$              | 23000                                                  | 质量，kg                              |
| 6    | $\alpha$         | 0                                                      | 攻角，rad                             |
| 7    | $\beta$          | 0                                                      | 侧滑角，rad                           |
| 8    | $\sigma$         | 0                                                      | 航向角，rad                           |
| 9    | $\varphi$        | 90                                                     | 俯仰角，rad                           |
| 10   | $\psi$           | 0                                                      | 偏航角，rad                           |
| 11   | $\delta_\varphi$ | 0                                                      | 发动机等效俯仰偏转角，rad             |
| 12   | $\delta_\psi$    | 0                                                      | 发动机等效俯仰偏航角，rad             |
| 13   | $h$              | 0                                                      | 高度，m                               |
| 14   | $\phi$           | $\varphi_0$                                            | 火箭地心纬度，$\degree$               |
| 15   | $R$              | $r_0$                                                  | 火箭地心纬度地面对应地心矢径的长度，m |
| 16   | $p_H$            | $p_0$                                                  | 火箭所在高度大气压力，Pa              |
| 17   | $\rho$           | 1.225                                                  | 火箭所在高度大气密度，$kg/m^3$        |

### 有关参数

| 序号 | 参数名        | 参数值                  | 物理意义及单位                    |
| ---- | ------------- | ----------------------- | --------------------------------- |
| 1.   | $m_0$         | 23000                   | 起飞质量，kg                      |
| 2.   | $\dot m$      | 100                     | 单位时间燃料质量消耗，$kg/s$      |
| 3.   | $J_2$         | $1.08263\times10^{-3}$  | 地球引力势二阶带谐系数            |
| 4.   | $a_0^\varphi$ | 0.5                     | 俯仰角度增益系数                  |
| 5.   | $a_0^\psi$    | 0.5                     | 偏航角度增益系数                  |
| 6.   | $P_0$         | $3\times10^5$           | 海平面推力，N                     |
| 7.   | $m_f$         | 1500                    | 结构质量，kg                      |
| 8.   | $m_z^\alpha$  | -0.12                   | 静稳定力矩系数，$/\degree$        |
| 9.   | $\omega_e$    | $7.29\times10^5$        | 地球自转角速度                    |
| 10.  | $C_x$         | $0.02+0.005\alpha^2$    | 阻力系数，攻角单位$\degree$       |
| 11.  | $L$           | 15                      | 火箭参考长度，m                   |
| 12.  | $ m_z^{C_y}$  | 10%                     | 静稳定度                          |
| 13.  | $\rho_e$      | 7                       | 火箭发动机喷口界面距离质心距离，m |
| 14.  | $x_g$         | 8                       | 火箭质心距离火箭头部的距离，m     |
| 15.  | $S_e$         | 0.1                     | 发动机喷口面积，$m^2$             |
| 16.  | $S_M$         | 3.14                    | 气动参考面积，$m^2$               |
| 17.  | $p_t$         | 0.4                     | 发动机出口压强，MPa               |
| 18.  | $\varphi_0$   | 19°19´N                 | 发射点地心纬度                    |
| 19.  | $\lambda_0$   | 109°48´E                | 发射点经度                        |
| 20.  | $A_0$         | 30                      | 发射方位角，°                     |
| 21.  | $a_e$         | 6378137                 | 地球椭球体长半轴，m               |
| 22.  | $b_e$         | 6356752                 | 地球椭球体短半轴，m               |
| 23.  | $p_0$         | 101325                  | 海平面大气压力，Pa                |
| 24.  | $f_mM$        | $3.986005\times10^{14}$ | 地球引力系数，$m^3/s^2$           |

## 目标

（1）根据如上已知条件，设计俯仰程序角，完成火箭纵向运动仿真。

（2）验证齐奥尔科夫斯基公式。

（3）计算火箭上升过程中重力速度损失、大气阻力速度损失和静压速度损失。

（4）计算火箭上升过程中程序俯仰角、俯仰角、攻角、弹道倾角、 发动机等效摆角随时间的变化规律，放在一张图上比较观察。

## 火箭动力学模型

发动机配置方式为“X”型布局的摆动发动机，可以认为火箭做理想的运动，不受扰动力和扰动力矩，忽略箭体的横滚，高阶项和控制系统的动态过程，使用“瞬时平衡”假设，则可以建模如下

### 坐标系及方向余弦矩阵

#### 使用的坐标系

| 坐标系         | 符号                |
| -------------- | ------------------- |
| 地心惯性坐标系 | $ O_E X_I Y_I Z_I $ |
| 地心坐标系     | $ O_E X_E Y_E Z_E $ |
| 地面发射坐标系 | $ oxyz $            |
| 箭体坐标系     | $ o_1 x_1 y_1 z_1 $ |
| 速度坐标系     | $ o_1 x_V y_V z_V $ |

#### 坐标系间的方向余弦矩阵

| 初始坐标系                        | 终坐标系                      | 方向余弦矩阵                                                 |
| --------------------------------- | ----------------------------- | ------------------------------------------------------------ |
| 地心惯性坐标系$ O_E X_I Y_I Z_I $ | 地心坐标系$ O_E X_E Y_E Z_E $ | $ \mathbf{E}_I=\mathbf{L_Z}(\Omega_G) $                      |
| 地心坐标系$ O_E X_E Y_E Z_E $     | 地面发射坐标系$ oxyz $        | $ \mathbf{G}_E=\mathbf{L}_Y(-90\degree-\alpha_0)\mathbf{L}_X(\varphi_0)\mathbf{L}_Z(\lambda_0-90\degree) $ |
| 地面发射坐标系$ oxyz $            | 箭体坐标系$ o_1 x_1 y_1 z_1 $ | $ \mathbf{B}_G=\mathbf{L}_X(\gamma)\mathbf{L}_Y(\psi)\mathbf{L}_Z(\varphi) $ |
| 地面发射坐标系$ oxyz $            | 速度坐标系$ o_1 x_V y_V z_V $ | $ \mathbf{V}_G=\mathbf{L}_X(\nu)\mathbf{L}_Y(\sigma)\mathbf{L}_Z(\theta) $ |
| 速度坐标系$ o_1 x_V y_V z_V $     | 箭体坐标系$ o_1 x_1 y_1 z_1 $ | $ \mathbf{B}_V=\mathbf{L}_Y(\alpha)\mathbf{L}_Z(\beta) $     |

### 火箭运动方程

#### 质心运动方程

| 符号        | 物理含义     | 坐标系              | 取值                                                         |
| ----------- | ------------ | ------------------- | ------------------------------------------------------------ |
| $\vec{P}$   | 推力项       | $ o_1 x_1 y_1 z_1 $ | $ \left [ \begin{matrix}P_0 + S_e(p_0-p_H) \\0\\ 0 \end{matrix}\right ]$ |
| $\vec{R}$   | 气动力项     | $ o_1 x_V y_V z_V $ | $ \left [ \begin{matrix}-C_x q S_M \\C_y^\alpha q S_M \alpha \\  -C_y^\alpha q S_M \beta\end{matrix}\right ]$ |
| $\vec{F_c}$ | 控制力项     | $ o_1 x_1 y_1 z_1 $ | $ \left [ \begin{matrix}0 \\\frac{\sqrt{2}}{2}P\delta_\varphi\\ -\frac{\sqrt{2}}{2}P\delta_\psi \end{matrix}\right ]$ |
| $m\vec{g}$  | 引力项       | $ oxyz $            | $m\frac{g'_r}{r}(\vec{R}_0+\vec{r})+mg_{\omega e}\frac{\vec{\omega_e}}{\omega} $ |
| $\vec{F}_e$ | 离心惯性力项 | $ oxyz $            | $-m\vec{\omega_e}\times(\vec{\omega_e}\times(\vec{r}+\vec{R_0}))$ |
| $\vec{F_k}$ | 哥氏惯性力项 | $ oxyz $            | $-2m\vec{\omega_e}\times\vec{V}$                             |

建立在地面发射坐标系下的质心运动方程
$$
\begin{aligned}
	\left. \begin{aligned}
	m\frac{d\vec{V}}{dt} &= \mathbf{B}_G^T(\vec{P}+\vec{F_c}) + \mathbf{V}_G^T\vec{R}+m\vec{g}+\vec{F_e}+\vec{F_k}\\
	\frac{d\vec{r}}{dt} &= \vec{V}
	
	\end{aligned}
	\right\}
\end{aligned}\tag{1}
$$

#### 绕质心运动方程

根据“瞬时平衡”假设，气动力矩和控制力矩满足
$$
\begin{aligned}
	\left. \begin{aligned}
	& M_{z1}^\alpha \alpha + M_{z1}^\delta \delta_\varphi=0 \\
	& M_{y1}^\beta \beta + M_{y1}^\delta \delta_\psi=0
	\end{aligned}
	\right\}
\end{aligned}\tag{2}
$$
对控制方程略去动态过程，有
$$
\begin{aligned}
	\left. \begin{aligned}
	&\delta_\varphi=a_0^\varphi(\varphi+\omega_{ez}t-\varphi_{pr}) \\
	&\delta_\psi=a_0^\psi(\psi+(\omega_{ey}\cos\varphi-\omega_{ex}\sin\varphi)t)
	\end{aligned}
	\right\}
\end{aligned}\tag{3}
$$
将$(3)$式代入$(2)$式，并根据欧拉角的转换关系，有
$$
\begin{aligned}
	\left. \begin{aligned}
	&\alpha=A_\varphi(\varphi_{pr}-\omega_{ez}t-\theta) \\
	&\beta=A_\psi[((\omega_{ex}\sin\varphi-\omega_{ey}\cos\varphi)t-\sigma]
	\end{aligned}
	\right\}
\end{aligned}\tag{4}
$$
其中，
$$
\begin{aligned}
	\left. \begin{aligned}
	&A_\varphi=\frac{a_0^\varphi M_{z1}^\delta}{M_{z1}^\alpha+a_0^\varphi M_{z1}^\delta} \\
	&A_\psi=\frac{a_0^\psi M_{y1}^\delta}{M_{y1}^\beta+a_0^\psi M_{y1}^\delta}
	\end{aligned}
	\right\}
\end{aligned}\tag{5}
$$

### 补充方程

引力加速度分量
$$
\begin{aligned}
	\left. \begin{aligned}
	&g_r'=-\frac{f_mM}{r^2}[1+\frac{3J_2}{2}(\frac{a_e}{r})^2(1-5\sin^2\varphi)] \\
	&g_{\omega_e}=-3\frac{f_mM}{r^2}J_2(\frac{a_e}{r})^2\sin\varphi
	\end{aligned}
	\right\}
\end{aligned}\tag{6}
$$

发射点地心矢径

$$
\begin{aligned}
	\left. \begin{aligned}
	&\vec{R_0}=r_0 \left [ \begin{matrix}-\sin\mu_0\cos A_0 \\ 
										 \cos\mu_0 \\
										 \sin\mu_0\sin A_0
							\end{matrix} \right ]\\
	&r_0=\frac{a_e b_e}{\sqrt{b_e^2\cos^2\varphi_0+a_e^2\sin^2\varphi_0}} \\
	&\tan B_0=\frac{a_e^2}{b_e^2}\tan\varphi_0 \\
	&\mu_0=B_0-\varphi_0
	\end{aligned}
	\right\}
\end{aligned}\tag{7}
$$

发动机控制力矩
$$
\begin{aligned}
	\left. \begin{aligned}
	&M_{y1}^\delta=-\frac{\sqrt{2}}{2}P\rho_e \\
	&M_{z1}^\delta=\frac{\sqrt{2}}{2}P\rho_e
	\end{aligned}
	\right\}
\end{aligned}\tag{8}
$$
气动力，气动力系数和气动力矩
$$
\begin{aligned}
	\left. \begin{aligned}
	&C_y^\alpha m_z^{C_y}=m_z^\alpha \\
	&m_z^\alpha q S_M L=M_{z1}^\alpha \\
	&M_{z1}^\alpha=-M_{y1}^\beta \\
	&q=\frac{1}{2}\rho \vec{V}^2
	\end{aligned}
	\right\}
\end{aligned}\tag{9}
$$
地球自转角速度
$$
\vec{\omega_e}=\omega_e\left [\begin{matrix}\cos B_0 \cos A_0 \\ \sin B_0 \\ -\cos B_0 \sin A_0\end{matrix}\right ] \tag{10}
$$
质量变化率
$$
m=m_0-\dot mt \tag{11}
$$
程序俯仰角
$$
\varphi_{pr} = \begin{cases}
				&\frac{\pi}{2}, \quad &0 \leq t < 10s \\
				&\frac{\pi}{2}+(\frac{\pi}{2}-66\degree)[(\frac{t-10}{90})^2-2\cdot\frac{t-10}{90}], \quad &10s \leq t < 100s \\
				&-\frac{11\pi}{3450}(t-215), \quad &100s \leq t \leq 215s
			   \end{cases} \tag{12}
$$
高度
$$
\begin{aligned}
	\left. \begin{aligned}
	&R=\frac{a_e b_e}{\sqrt{b_e^2\cos^2\phi+a_e^2\sin^2\phi}} \\
	&h=\lvert \vec{r}+\vec{R_0} \rvert-R
	\end{aligned}
	\right\}
\end{aligned}\tag{13}
$$
$p_H$和$\rho$通过查表插值获取，$h>86 km$时认为$p_H=0,\rho=0$



欧拉角关系
$$
\begin{aligned}
	\left. \begin{aligned}
	&\theta=arctan\frac{v_y}{v_x} \\
	&\sigma=-arcsin\frac{v_z}{v} \\
	&\varphi=\theta+\alpha \\
	&\psi=\sigma+\beta
	\end{aligned}
	\right\}
\end{aligned}\tag{14}
$$


## 代码实现

